# üíß Zaino Web - Fluj√≥metro de Agua en Tiempo Real

![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)
![Flask](https://img.shields.io/badge/Flask-2.0+-green.svg)
![Arduino IoT](https://img.shields.io/badge/Arduino-IoT%20Cloud-00979D.svg)
![License](https://img.shields.io/badge/License-MIT-yellow.svg)

## üìã Descripci√≥n

**Zaino Web** es una aplicaci√≥n web desarrollada en colaboraci√≥n con el **Instituto Profesional AIEP** para una comunidad que necesitaba monitorear en tiempo real el caudal de agua de un r√≠o. La soluci√≥n integra hardware IoT con Arduino, sensores de flujo, y una interfaz web moderna desarrollada con Python Flask, permitiendo visualizar datos en tiempo real, estad√≠sticas hist√≥ricas y generar informes.

Este proyecto combina tecnolog√≠as de IoT, backend con Flask, y un frontend responsive para ofrecer una experiencia completa de monitoreo h√≠drico.

---

## ‚ú® Caracter√≠sticas Principales

### üåä Monitoreo en Tiempo Real
- **Flujo instant√°neo** (L/min) con medidor visual tipo gauge
- **Flujo acumulado** total de litros
- **Gr√°fico hist√≥rico** de los √∫ltimos 5 minutos
- **Actualizaci√≥n autom√°tica** cada 10 segundos
- **Estad√≠sticas en vivo**: m√°ximo, m√≠nimo y promedio

### üå§Ô∏è Datos Meteorol√≥gicos
- Integraci√≥n con **Weathercloud API**
- Temperatura y sensaci√≥n t√©rmica
- Presi√≥n atmosf√©rica
- Indicadores visuales del clima

### üìä Panel de Control
- **Dashboard intuitivo** con m√©tricas clave
- **Vista responsive** para m√≥viles, tablets y desktop
- **Sistema de cach√©** para optimizar peticiones
- **Gesti√≥n de informes** (descarga y visualizaci√≥n)

### üé® Interfaz Moderna
- Dise√±o **Material Design** con gradientes
- **Animaciones suaves** y transiciones
- **Modo oscuro** en men√∫ lateral
- **Iconos Bootstrap** para mejor UX

---

## üõ†Ô∏è Tecnolog√≠as Utilizadas

### Backend
- **Python 3.8+**
- **Flask 2.0+** - Framework web
- **Requests** - Cliente HTTP
- **OAuth2Session** - Autenticaci√≥n con Arduino IoT Cloud
- **Python-dotenv** - Gesti√≥n de variables de entorno

### Frontend
- **HTML5 / CSS3**
- **JavaScript (ES6+)**
- **jQuery 3.6**
- **Bootstrap 5.3** - Framework CSS
- **Bootstrap Icons** - Iconograf√≠a
- **SVG** - Gr√°ficos vectoriales para visualizaciones

### APIs Integradas
- **Arduino IoT Cloud API** - Obtenci√≥n de datos del fluj√≥metro
- **Weathercloud API** - Datos meteorol√≥gicos en tiempo real

### IoT Hardware
- **Arduino** con conectividad IoT
- **Sensores de flujo** para medici√≥n de caudal
- **Comunicaci√≥n en tiempo real** con Arduino IoT Cloud

---

## üìÅ Estructura del Proyecto

```
zaino-web/
‚îÇ
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api_controller.py      # Endpoints de la API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app_controller.py      # Controladores de vistas
‚îÇ   ‚îú‚îÄ‚îÄ static/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app.css            # Estilos principales
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app.js             # L√≥gica principal
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ debug.js           # Herramientas de debug
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ img/                   # Im√°genes y recursos
‚îÇ   ‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app.html               # Template principal
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ config.py              # Configuraci√≥n
‚îÇ       ‚îî‚îÄ‚îÄ weathercloud_py.py     # Cliente Weathercloud
‚îÇ
‚îú‚îÄ‚îÄ .env                           # Variables de entorno (no incluido)
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ app.py                         # Punto de entrada
‚îú‚îÄ‚îÄ Pipfile                        # Dependencias Pipenv
‚îú‚îÄ‚îÄ requirements.txt               # Dependencias pip
‚îú‚îÄ‚îÄ visitas.json                   # Contador de visitas
‚îî‚îÄ‚îÄ README.md
```

---

## ‚öôÔ∏è Configuraci√≥n

### 1. Variables de Entorno (`.env`)

Crea un archivo `.env` en la ra√≠z del proyecto con las siguientes variables:

```env
# Arduino IoT Cloud Credentials
CLIENT_ID=tu_client_id_de_arduino
CLIENT_SECRET=tu_client_secret_de_arduino

# Weathercloud API Credentials
WEATHERCLOUD_EMAIL=tu_email@example.com
WEATHERCLOUD_PASSWORD=tu_password_weathercloud

# Configuraci√≥n de estaci√≥n meteorol√≥gica
WEATHERCLOUD_DEVICEID=ID_DE_TU_ESTACION

# Flask Security - Clave secreta (IMPORTANTE EN PRODUCCI√ìN)
# Genera una con: python -c "import os; print(os.urandom(24).hex())"
SECRET_KEY=tu_clave_secreta_aleatoria_aqui
```

> **Nota de Seguridad**: Si no especificas una `SECRET_KEY`, la aplicaci√≥n generar√° una aleatoria autom√°ticamente. Sin embargo, esto har√° que las sesiones se invaliden cada vez que reinicies el servidor. Para producci√≥n, **siempre configura una SECRET_KEY fija**.

### 2. Obtener Credenciales

#### Arduino IoT Cloud
1. Crea una cuenta en [Arduino IoT Cloud](https://cloud.arduino.cc/)
2. Ve a **API Keys** en tu panel
3. Crea un nuevo **Client ID** y **Client Secret**
4. Configura un **Thing** llamado "Medidor de Flujo" con propiedades:
   - `constflow` (float): Flujo instant√°neo en L/min
   - `instflow` (float): Flujo acumulado en Litros

#### Weathercloud
1. Reg√≠strate en [Weathercloud](https://weathercloud.net/)
2. Obt√©n el ID de tu estaci√≥n meteorol√≥gica
3. Usa tus credenciales de login

---

## üöÄ Instalaci√≥n

### Prerequisitos
- Python 3.8 o superior
- pip o pipenv
- Git

### Opci√≥n 1: Usando Pipenv (Recomendado)

```bash
# Clonar el repositorio
git clone https://github.com/tu-usuario/zaino-web.git
cd zaino-web

# Instalar pipenv si no lo tienes
pip install pipenv

# Instalar dependencias
pipenv install

# Activar el entorno virtual
pipenv shell

# Crear archivo .env y configurar variables
cp .env.example .env
# Edita el archivo .env con tus credenciales

# Ejecutar la aplicaci√≥n
python app.py
```

### Opci√≥n 2: Usando pip

```bash
# Clonar el repositorio
git clone https://github.com/tu-usuario/zaino-web.git
cd zaino-web

# Crear entorno virtual
python -m venv venv

# Activar entorno virtual
# En Windows:
venv\Scripts\activate
# En Linux/Mac:
source venv/bin/activate

# Instalar dependencias
pip install -r requirements.txt

# Crear archivo .env y configurar variables
cp .env.example .env
# Edita el archivo .env con tus credenciales

# Ejecutar la aplicaci√≥n
python app.py
```

La aplicaci√≥n estar√° disponible en: `http://localhost:5000`

---

## üåê Despliegue

### URL Oficial
üîó **Producci√≥n**: [https://example.com](https://example.com)  
üîó **Demo**: [https://demo.example.com](https://demo.example.com)

*Nota: Actualiza estas URLs con tu dominio real cuando despliegues la aplicaci√≥n.*

### Despliegue en Producci√≥n

Para desplegar en producci√≥n, considera:

1. **Configurar variables de entorno** en tu servidor
2. **Usar un servidor WSGI** como Gunicorn:
   ```bash
   pip install gunicorn
   gunicorn -w 4 -b 0.0.0.0:8000 app:app
   ```
3. **Configurar HTTPS** con Let's Encrypt
4. **Usar un proxy reverso** como Nginx
5. **Configurar CORS** seg√∫n tus necesidades

---

## üìä API Endpoints

### Fluj√≥metro
- `GET /api/arduino/flowmeter` - Obtiene datos del fluj√≥metro
- `GET /api/test-api` - Prueba conexi√≥n con Arduino IoT Cloud

### Clima
- `GET /api/weather` - Datos de estaci√≥n por defecto
- `GET /api/weather/<station_id>` - Datos de estaci√≥n espec√≠fica
- `GET /api/weather/nearest?lat={lat}&lon={lon}&radius={radius}` - Estaciones cercanas
- `GET /api/weather/profile/<station_id>` - Perfil de estaci√≥n
- `GET /api/weather/statistics/<station_id>` - Estad√≠sticas de estaci√≥n

### Utilidades
- `POST /api/visitas` - Incrementa contador de visitas

---

## üéØ Caracter√≠sticas T√©cnicas

### Sistema de Cach√©
- **TTL**: 8 segundos para datos del fluj√≥metro
- **Reducci√≥n**: ~95% menos peticiones a Arduino IoT Cloud
- **Fallback autom√°tico** en caso de rate limiting (429)

### Responsive Design
- **Mobile-first** approach
- **Breakpoints**: 480px, 768px, 1024px
- **Adaptaci√≥n autom√°tica** de layout en tablets y m√≥viles
- **Touch-friendly** para dispositivos t√°ctiles

### Optimizaciones
- **Lazy loading** de datos
- **Debouncing** en resize events
- **Peticiones controladas** para evitar rate limiting
- **Animaciones con CSS** para mejor rendimiento

---

## ü§ù Contribuir

Las contribuciones son bienvenidas. Para contribuir:

1. Fork el proyecto
2. Crea una rama para tu feature (`git checkout -b feature/AmazingFeature`)
3. Commit tus cambios (`git commit -m 'Add some AmazingFeature'`)
4. Push a la rama (`git push origin feature/AmazingFeature`)
5. Abre un Pull Request

---

## üìù Licencia

Este proyecto est√° bajo la Licencia MIT - ver el archivo [LICENSE](LICENSE) para m√°s detalles.

---

## üë• Autores

- **Desarrollo**: En colaboraci√≥n con Instituto Profesional AIEP
- **Comunidad**: Proyecto desarrollado para monitoreo comunitario de recursos h√≠dricos

---

## üìß Contacto

Para preguntas, sugerencias o reportar problemas:

- **Issues**: [GitHub Issues](https://github.com/tu-usuario/zaino-web/issues)
- **Email**: contacto@example.com

---

## üôè Agradecimientos

- Instituto Profesional AIEP por el apoyo en el desarrollo
- Arduino IoT Cloud por proporcionar la infraestructura IoT
- Weathercloud por los datos meteorol√≥gicos
- La comunidad que inspir√≥ este proyecto

---

## üì∏ Capturas de Pantalla

### Dashboard Principal
![Dashboard](docs/screenshots/dashboard.png)

### Vista M√≥vil
![Mobile](docs/screenshots/mobile.png)

### Monitoreo en Tiempo Real
![Real-time](docs/screenshots/realtime.png)

---

**Zaino Web** - Monitoreo inteligente de recursos h√≠dricos üíß